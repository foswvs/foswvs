<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
<title>admin</title>
<link href="/css/normalize.css" rel="stylesheet">
<link href="/css/skeleton.css" rel="stylesheet">
<link href="/css/a.css" rel="stylesheet">
</head>
<body>
<div class="container">
  <div class="row" style="margin-top:5%;">
    <div style="max-width:380px;margin:auto;border:1px solid #ccc;padding:20px 20px 0 20px;border-radius:4px;">
      <label>ADMIN DASHBOARD</label>
      <form action="#" id="login" onsubmit="return false">
        <input class="u-full-width" name="password" type="password" placeholder="password">
        <input class="button-primary" type="submit" value="login">
        <a class="button" href="/">EXIT</a>
      </form>
    </div>
    <p style="text-align:center;margin-top:10px;">CPU temp: <span id="cpu_temp">0</span>&#176; | <span id="uptime">0</span></p>
  </div>
</div>
<script>
document.addEventListener('click', function(e) {
  if( e.target.parentNode.id == 'login' ) {
    let form = e.target.parentNode;

    if( form.password.value ) {
      fetch('./x.php?net=login', {
        method: 'POST',
        body: new FormData(form)
      }).then((x) => {
        if(x.status==200) {
          window.location.href = '/a/active_devices.html';
        }
      });
    }
  }
})

function cpu_temp() {
  fetch('/api/cpu_temp.php').then((r) => r.text()).then((r) => { document.getElementById('cpu_temp').innerText=parseFloat(r).toFixed(2); setTimeout(cpu_temp,30000); });
}

function uptime() {
  fetch('/api/uptime.php').then((r) => r.text()).then((r) => document.getElementById('uptime').innerText=r);
}

cpu_temp(); uptime();
</script>
</body>
</html>
